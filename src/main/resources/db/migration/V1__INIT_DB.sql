CREATE SCHEMA PUBLIC AUTHORIZATION DBA
SET SCHEMA PUBLIC

CREATE MEMORY TABLE PUBLIC.CALENDAR_BOOK(
	ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	END TIMESTAMP,
	START TIMESTAMP,
	RESOURCE_ID BIGINT,
	USER_REF_ID BIGINT
);

CREATE MEMORY TABLE PUBLIC.RESOURCE(
	ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	DESCRIPTION VARCHAR(255) NOT NULL,
	TYPE VARCHAR(255) NOT NULL
);

CREATE MEMORY TABLE PUBLIC.USER(
	ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	EMAIL VARCHAR(255) NOT NULL,
	NAME VARCHAR(255) NOT NULL,
	SURNAME VARCHAR(255) NOT NULL,
	CHECK_SUM VARCHAR(255) NOT NULL
);

CREATE MEMORY TABLE PUBLIC.SCHEMA_VERSION(
	INSTALLED_RANK INTEGER NOT NULL,
	VERSION VARCHAR(50),
	DESCRIPTION VARCHAR(200) NOT NULL,
	TYPE VARCHAR(20) NOT NULL,
	SCRIPT VARCHAR(1000) NOT NULL,
	CHECKSUM INTEGER,
	INSTALLED_BY VARCHAR(100) NOT NULL,
	INSTALLED_ON TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
	EXECUTION_TIME INTEGER NOT NULL,
	SUCCESS BIT(1) NOT NULL,
	CONSTRAINT SCHEMA_VERSION_PK PRIMARY KEY(INSTALLED_RANK)
);

CREATE INDEX SCHEMA_VERSION_S_IDX ON PUBLIC.SCHEMA_VERSION(SUCCESS);

ALTER TABLE PUBLIC.CALENDAR_BOOK ADD CONSTRAINT FKMINCJ9AX59E01OO4NRPFSS750 FOREIGN KEY(RESOURCE_ID) REFERENCES PUBLIC.RESOURCE(ID)
ALTER TABLE PUBLIC.CALENDAR_BOOK ADD CONSTRAINT FKRMLTSDEUJVDOY00H3KGNHMRHN FOREIGN KEY(USER_REF_ID) REFERENCES PUBLIC.USER(ID)

SET DATABASE DEFAULT INITIAL SCHEMA PUBLIC